<div class="smallcontent">
<p>This is tiny content</p>
</div>
<p>This is normal content, <span data-latex-fontsize="small">small span</span> and <code class="largecontent important">huge code</code>.</p>
<pre class="smallcontent"><code>And a piece of tiny code.</code></pre>
<pre class="smallcontent"><code>$mockRepo = $this-&gt;createMock(ProductRepository::class);</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode php"><code class="sourceCode php"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">$mockRepo</span> = <span class="kw">$this</span>-&gt;createMock<span class="ot">(</span>ProductRepository::<span class="kw">class</span><span class="ot">);</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode php"><code class="sourceCode php"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">$stub</span> = <span class="kw">$this</span>-&gt;createMock<span class="ot">(</span>SomeClass::<span class="kw">class</span><span class="ot">);</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">// stubbing by calling `method()`. Only be valid, if no function named `method` in original class</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;willReturn<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">);</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">// stubbing by calling `expects()-&gt;method()`</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">$stub</span>-&gt;expects<span class="ot">(</span><span class="kw">$this</span>-&gt;any<span class="ot">())</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;willReturn<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">);</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">// 现在调用 $stub-&gt;doSomething() 将返回 &#39;foo&#39;。</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="kw">$this</span>-&gt;assertEquals<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">());</span></a></code></pre></div>
<p class="tip">
用 willReturn(<span class="math inline"><em>v</em><em>a</em><em>l</em><em>u</em><em>e</em>)<em>返</em><em>回</em><em>简</em><em>单</em><em>值</em>。<em>这</em><em>个</em><em>简</em><em>短</em><em>的</em><em>语</em><em>法</em><em>相</em><em>当</em><em>于</em><em>w</em><em>i</em><em>l</em><em>l</em>(</span>this-&gt;returnValue($value))。而在这个长点的语法中，可以使用变量，从而实现更复杂的上桩行为。
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode php"><code class="sourceCode php"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">$stub</span> = <span class="kw">$this</span>-&gt;createMock<span class="ot">(</span>SomeClass::<span class="kw">class</span><span class="ot">);</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">//01: returns `foo`</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;willReturn<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">);</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;will<span class="ot">(</span><span class="kw">$this</span>-&gt;returnValue<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">));</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">$this</span>-&gt;assertSame<span class="ot">(</span><span class="st">&#39;foo&#39;</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">());</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">//02: returns arg1</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;will<span class="ot">(</span><span class="kw">$this</span>-&gt;returnArgument<span class="ot">(</span><span class="dv">0</span><span class="ot">));</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">$this</span>-&gt;assertSame<span class="ot">(</span><span class="kw">$foo</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">(</span><span class="kw">$foo</span><span class="ot">,</span> <span class="kw">$bar</span><span class="ot">));</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">//03: return stub self</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span>-&gt;will<span class="ot">(</span><span class="kw">$this</span>-&gt;returnSelf<span class="ot">());</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">$this</span>-&gt;assertSame<span class="ot">(</span><span class="kw">$stub</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">());</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">//04: returns mapped data</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">// 创建从参数到返回值的映射。</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="kw">$map</span> = <span class="ot">[</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">    <span class="ot">[</span><span class="st">&#39;a&#39;</span><span class="ot">,</span> <span class="st">&#39;b&#39;</span><span class="ot">,</span> <span class="st">&#39;c&#39;</span><span class="ot">,</span> <span class="st">&#39;111&#39;</span><span class="ot">],</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20">    <span class="ot">[</span><span class="st">&#39;e&#39;</span><span class="ot">,</span> <span class="st">&#39;f&#39;</span><span class="ot">,</span> <span class="st">&#39;g&#39;</span><span class="ot">,</span> <span class="st">&#39;999&#39;</span><span class="ot">]</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="ot">];</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">// 配置桩件。</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="kw">$stub</span>-&gt;method<span class="ot">(</span><span class="st">&#39;doSomething&#39;</span><span class="ot">)</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">     -&gt;will<span class="ot">(</span><span class="kw">$this</span>-&gt;returnValueMap<span class="ot">(</span><span class="kw">$map</span><span class="ot">));</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">// $stub-&gt;doSomething() 根据提供的参数返回不同的值。</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="kw">$this</span>-&gt;assertEquals<span class="ot">(</span><span class="st">&#39;111&#39;</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">(</span><span class="st">&#39;a&#39;</span><span class="ot">,</span> <span class="st">&#39;b&#39;</span><span class="ot">,</span> <span class="st">&#39;c&#39;</span><span class="ot">));</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="kw">$this</span>-&gt;assertEquals<span class="ot">(</span><span class="st">&#39;999&#39;</span><span class="ot">,</span> <span class="kw">$stub</span>-&gt;doSomething<span class="ot">(</span><span class="st">&#39;e&#39;</span><span class="ot">,</span> <span class="st">&#39;f&#39;</span><span class="ot">,</span> <span class="st">&#39;g&#39;</span><span class="ot">));</span></a></code></pre></div>
<h5 id="getmockbuilder">getMockBuilder()</h5>
<p>如果这些默认值非你所需，可以用 getMockBuilder(ClassName::class) 方法并使用流畅式接口来定制Mock的生成过程。</p>
<h2 id="behat">Behat</h2>
<h2 id="codeception">Codeception</h2>
